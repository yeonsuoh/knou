# 14강 해시함수 및 전자서명

## 01. 해시함수

### 해시(hash)함수의 개념

- 임의의 길이의 입력 데이터를 고정된 길이의 해시코드로 대응시키는 함수
- 일방향 함수
    - 임의의 데이터에 대한 해시코드는 쉽게 생성
    - 해시코드에 대응되는 데이터를 거꾸로 찾는 것은 어려움

### 해시 함수의 응용 분야

- 메시지 인증
    - HMAC
- 전자서명
- 의사 난수 생성기(PRNG)
    - PseudoRandomNumber Generator

### 해시함수 𝑯의 요구조건

- 𝑯는 임의의 크기의 입력 데이터 𝑫에 적용 가능
- 𝑯는 일정한 크기의 해시코드 𝒉 출력
- 𝑯와 입력 데이터 𝑫가 주어졌을 때, 해시코드 𝒉 = 𝑯(𝑫)를 계산하기 쉬울 것
- 약한 일방향성, 강한 일방향성, 충돌저항성

- 약한 일방향성
    - 𝑯와 해시코드 𝒉가 주어졌을 때, 𝒉 = 𝑯(𝑫)를 만족하는 입력 데이터 𝑫를 구하는 것이 계산상 실행 불가능

- 강한 일방향성
    - 𝑯와 입력 데이터 𝑫가 주어졌을 때, 𝑯 (𝑫) = 𝑯(𝑫′)을 만족하는 다른 입력 데이터 𝑫′을 구하는 것이 계산상 실행 불가능

- 충돌저항성
    - 𝑯가 주어졌을 때, 𝑯 𝑫 = 𝑯(𝑫′)을 만족하는
      두 입력 데이터 𝑫와 𝑫′을 구하는 것이 계산상 실행 불가능

### 해시 알고리즘

- 블록 암호 알고리즘에 기초한 해시 알고리즘
    - 블록 암호보다 속도가 훨씬 떨어짐
- 모듈러 연산을 이용한 해시 알고리즘
    - 속도가 느려 사용 영역에 제한
- 전용 해시 알고리즘

### 전용 해시 알고리즘

- MD4(Message Digest 4)
    - 1990년 발표
    - MD5, RIPEMD, RIPEMD-160, SHA-1 등 많은 전용 해시 알고리즘의 기본 모델
- MD5
    - MD4보다 보수적으로 설계
    - 해시코드 크기: 128비트
    - 널리 이용되었으나, 일방향성과 충돌저항성에 문제가 있음이 알려져 사용하지 말 것을 권고

- SHA-1(Secure Hash Algorithm-1)
    - 1995년 발표된 표준 해시 알고리즘
    - 2^64비트보다 작은 크기의 입력 데이터에 적용 가능
    - 해시코드 크기 : 160비트
    - 조금씩 취약성이 드러나고 있음

- SHA-2
    - 2002년 표준 해시 알고리즘에 추가
    - 해시코드 크기에 따라 SHA-224, SHA-256, SHA-384, SHA-512 존재
    - SHA-224, SHA-256
        - 2^64비트보다 작은 크기의 입력 데이터에 적용 가능
    - SHA-384, SHA-512
        - 2^128비트보다 작은 크기의 입력 데이터에 적용 가능

- SHA-3
    - 2015년 표준 해시 알고리즘에 추가
    - SHA-1, SHA-2와 달리 완전히 새로운 구조로 만들어짐
        - 스펀지 구조
    - 입력 데이터의 크기 제한 없음
    - 해시코드 크기
        - 고정: SHA3-224, SHA3-256, SHA3-384, SHA3-512
        - 가변: SHAKE128, SHAKE256

## 02 전자서명

- Digital Signature
- 메시지를 보낸 사람의 신원이 진짜임을 증명
- 전달된 메시지의 원래 내용이 변조되지 않았음을 보증
- 메시지의 암호화 여부에 상관없이 사용

### 전자서명의 사용 예

- 인증서
    - 인증서 발급기관의 전자서명이 담겨 있음
    - 누구라도 그 인증서가 진짜임을 확인 가능

### 전자서명 사용의 부가적인 이득

- 전자서명이 쉽게 전송될 수 있음
- 전자서명을 쉽게 부인할 수 없음
- 전자서명을 다른 사람이 흉내 낼 수 없음
- 타임스탬프가 자동으로 유지될 수 있음

### 전자서명의 요구조건

- 전자서명은 서명되는 메시지에 의존하는 비트값임
- 전자서명은 서명자만의 고유정보를 사용해야 함
- 전자서명 생성 및 검증이 비교적 쉬워야 함
- 전자서명의 위조는 계산적으로 불가능해야 함
- 전자서명의 복사본을 저장소에 손쉽게 보관할 수 있음

  ➔ 해시함수와 공개키 암호 사용


### 전자서명의 동작원리

- 서명
    - 해시함수: 메시지에 의존하지만 작은 크기의 데이터 생성
    - 개인키: 오직 서명자 자신만 서명할 수 있음
- 검증
    - 공개키: 누구나 서명을 검증할 수 있음

### 전자서명 기법의 종류

- ElGamal 전자서명 기법
    - 이산대수 문제에 기반한 공개키 암호 방식 이용
- Schnorr 전자서명 기법
    - 이산대수 문제에 기반한 공개키 암호 방식 이용
- 전자서명표준

### 전자서명표준(DSS)

- Digital Signature Standard
- 세 가지 기법으로 구성
    - DSA(Digital Signature Algorithm)
        - ElGamal과 Schnorr 기법에 기반
    - RSA전자서명 알고리즘
        - RSA 알고리즘에 기반
    - ECDSA(Elliptic Curve Digital Signature Algorithm)
        - 타원곡선 암호에 기반