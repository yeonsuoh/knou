# 15강 키 관리

## 01 대칭키 암호의 키 관리

### 디피-헬먼 키 교환(DHKE) 프로토콜

- Diffie-Hellman Key Exchange
- 이산대수 문제에 기반하여 비밀키를 안전하게 공유하는 방법
- 큰 소수 𝒑와 양의 정수 𝒈 이용
    - 𝑔 < 𝑝
    - 𝑔^𝑥 ≡ 1(mod 𝑝)를 만족하는 가장 작은 𝑥가 𝑝 − 1인 𝑔
- 𝒑와 𝒈는 제3자가 알아도 됨

### 중간자 공격(MITM)

- Man In The Middle attack
- DHKE 프로토콜을 이용한 비밀키 공유를 무력화
- 해결 방법: 상대에 대한 인증 필요

## 02 공개키 암호의 키 관리

### 공개선언

- 공개키를 공개적으로 선언
    - 자신의 홈페이지에 올려 두거나 요청자에게 직접 보냄
- 홈페이지 또는 전달 도중 공격받아 공개키가 바뀔 위험 존재

### 신뢰받는 센터

- 모든 사람의 공개키를 신뢰받는 센터가 관리
    - 센터의 디렉터리에 사람들이 공개키를 올림
    - 센터는 공개키에 관한 모든 질의에 응답
- 전달 도중 공개키가 바뀔 위험 존재

### 통제된 신뢰받는 센터

- 공개키를 분배할 때 센터의 서명을 붙임
    - 공개키 요청 시 타임스탬프를 같이 받음
    - 타임스탬프에 대한 센터의 서명을 공개키와 함께 보냄
- 공개키에 대한 변조 가능성, 많은 요청에 대한 센터의 부하

### 인증기관(CA)

- 공개키 인증서를 만들어 분배
    - 인증서: 개인의 공개키에 인증기관의 서명을 붙인 것
    - 사람들의 공개키를 인증서로 변환하여 디렉터리에 올림
- 분배 받은 인증서는 인증기관의 공개키로 서명 검증

## 03 공개키 기반 구조 (PKI)

- Public Key Infrastructure
- X.509에 기초해서 인증서를 생성하고 분배, 인증 및 폐지까지 관리하는 체계
- 공개키 암호를 통해 암호화 및 전자서명을 제공하는 복합적인 보안 시스템
    - 제공 서비스: 기밀성, 무결성, 접근제어, 인증 부인방지
- 응용 분야
    - 은행 지불결제 시스템, 기관 간 전자문서 교환, 병원 의무기록에 대한 서명 등

### X.509

- 공통 규격이 없으면 사용자들은 인증서마다 별도 프로그램을 사용해야 하므로 많은 불편 초래

### PKI의 구성요소

- 사용자
    - 다양한 응용에서 전자서명을 생성 및 검증, 암·복호화 수행
- 인증기관
    - 공개키에 대한 인증서를 발급
- 등록기관
    - 사용자들의 인증서 신청 시 신분과 소속을 확인함
- 디렉터리
  • 인증서, 사용자 관련 정보, 상호인증서 쌍, 인증서 취소목록 등을 저장 및 검색하는 장소

### PKI의 관리대상

- 인증서
    - 인증서 관리 서비스는 PKI의 핵심
    - 인증서 발행, 취소, 공표, 보관
    - 정책 수립 및 승인
- 상호인증서 쌍
    - 한 도메인이나 서로 다른 도메인의 인증기관 사이에 발행하는 인증서의 쌍
        - 순방향 인증서: 인증기관 X에 대해 다른 인증기관에서 생성
        - 역방향 인증서: 인증기관 X가 다른 인증기관에 생성
        - 상호인증서를 사용하여 인증경로 단축 가능
- 인증서 취소목록 (CRL)
    - Certificate Revocation List
    - 효력이 상실된 인증서에 대한 목록
    - 유효기간 만기 전에 인증서 효력이 상실되는 경우
        - 개인키가 노출됨
        - 소유자가 다른 도메인으로 옮김 등

### PKI의 신뢰 구성

- PKI에서 신뢰는 인증경로를 통해 전달됨
- 전자서명 검증 과정
    - 검증자는 자신이 신뢰하는 인증기관의 공개키만 알고 있음
    - 인증기관의 공개키를 이용하여 인증경로를 검증함으로써  서명자의 공개키를 획득함
    - 획득한 공개키는 무결성이 보장되며, 이를 이용하여 서명을 검증함
- PKI의 구성 형태
    - 계층적 구성
        - 상위 CA가 하위 CA에 인증서를 발행
        - 루트 CA의 공개키는 모든 사람에게 알려짐
    - 네트워크 구성
        - CA가 독립적으로 존재하며 서로를 상호인증
        - 사용자는 자신의 인증서를 발행한 CA의 공개키만 앎